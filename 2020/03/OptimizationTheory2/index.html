<!DOCTYPE html>
<html lang="zh-CN">


<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/icon/titleIcon.png">
  <link rel="icon" type="image/png" href="/img/icon/titleIcon.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="author" content="Coumarin">
  
    <meta name="description" content="Coumarin">
  
  
    <meta name="keywords" content="Optimization Theory," />
  
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <title>一维最优化问题 ~ Coumarin</title>
  <link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/5.10.0/css/all.min.css"  >
<link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.3.1/css/bootstrap.min.css"  >
<link rel="stylesheet" href="https://cdn.staticfile.org/mdbootstrap/4.8.7/css/mdb.min.css"  >
<link rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/3.0.1/github-markdown.min.css"  >

<link rel="stylesheet" href="//at.alicdn.com/t/font_1067060_qzomjdt8bmp.css">


  <link rel="stylesheet" href="/lib/prettify/tomorrow-night-eighties.min.css"  >


  <link rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css"  >

<link rel="stylesheet" href="/css/main.css"  >
<script src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js" ></script>
  <style type="text/css">
    .banner-bg {
      
      background-position: center;
      background-repeat: repeat-y;
      background-size: cover;
      background-attachment: fixed;
    }
  </style>
<meta name="generator" content="Hexo 4.2.1"></head>

<body class="banner-bg">
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>Coumarin</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/">首页</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/archives/">归档</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/categories/">分类</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/tags/">标签</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/links/">友链</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/about/">关于</a>
          </li>
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>


</nav>

    <div class="view intro-2 rgba-black-slight" id="background">
      <div class="full-bg-img">
        <div class="mask flex-center">
          <div class="container text-center white-text fadeInUp">
            <span class="h2" id="subtitle">
              
            </span>
            
              <br>
              <p class="mt-3">
                <i class="far fa-calendar-alt"></i>
                <span class="post-date">2020/03/04&nbsp;|&nbsp;</span>
                <i class="far fa-chart-bar"></i>
                <span class="post-count">5.7k</span>字&nbsp;|&nbsp;
                <i class="far fa-clock"></i>
                <span class="post-count">29</span>分钟
                
                  <span id="busuanzi_container_page_pv" style="display:none">
                    &nbsp;|&nbsp;
                    <i class="far fa-eye"></i>
                    <span id="busuanzi_value_page_pv"></span>次
                  </span>
                
              </p>
            
          </div>
          
        </div>
      </div>
    </div>
  </header>
  <main id="mainContent" class="rgba-black-slight">
    
      

<div class="container-fluid">
  <div class="row">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-md">
      <div class="py-5 z-depth-3" id="board">
        <div class="post-content mx-auto" id="post">
          <div class="markdown-body">
            <p>本文基本上是老师的讲义, 少部分为自己理解或修改.</p>
<p>首先回忆最优化问题的形式.</p>
\begin{equation*}
\min_{x \in \R^n} f(x),\quad \st x \in X.\end{equation*}
<p>考虑最简单的情况: $n = 1$, 此时考虑的函数为 $f : \R \to \R$, $X$ 可以是 $(-\infty, a]$, $[a, b]$, $[b, +\infty)$, 也可以是这些区间的并集. 为方便起见, 先考虑无约束的一维最优化问题:<br>\begin{equation}\label{equ:notResOneOpt}<br>\min_{x \in \R} f(x).<br>\end{equation}</p>
<ul>
<li>它是高维优化问题的基础.</li>
<li>一般只考虑非线性的 $f$, 线性的情况是平凡的.</li>
<li>假设 $f \in C^1$, 若 $x^* \in \R$ 是问题 \eqref{equ:notResOneOpt} 的解, 则有 $f’(x^*) = 0$, 于是我们获得了一个必要条件<br>\begin{equation}\label{equ:fpxEqu0}<br>f’(x) = 0.<br>\end{equation}</li>
</ul>
<h1 id="Newton-法"><a href="#Newton-法" class="headerlink" title="Newton 法"></a>Newton 法</h1><p><strong>例</strong> $x^2 = 2$, 希望求出正根. 观察函数图像可知正根大于 $1$ 小于 $2$. 我们取初始的 $x = 1$.</p>
<ol>
<li><p>$x = 1 + \ep$, $0 &lt; \ep &lt; 1$, 有 $(1 + \ep)^2 = 2$, 展开得 $1 + 2\ep + \ep^2 = 2$ 忽略二次项, 解得 $\ep \approx \dfrac{1}{2}$, 得到 $x \approx 1.5$.</p>
</li>
<li><p>$x = 1.5 + \ep$, $0 &lt; \ep &lt; 1$, 有 $(1.5 + \ep)^2 = 2$, 展开得 $2.25 + 3\ep + \ep^2 = 2$ 忽略二次项, 解得 $\ep \approx -\dfrac{1}{12}$, 得到 $x \approx 1.416$.</p>
</li>
<li><p>$x = 1.5 - \dfrac{1}{12} + \ep$, $\cdots$</p>
</li>
</ol>
<h2 id="Newton-法的思想"><a href="#Newton-法的思想" class="headerlink" title="Newton 法的思想"></a>Newton 法的思想</h2><p>先猜测一个初值, 然后 $x \approx x_k + \ep$, 前面做的实际上是进行了一个二阶的 Taylor 展开</p>
\begin{equation*}
P(x_k + \ep) = 0 \Rightarrow P(x_k) + \ep P'(x_k) + O(\ep^2).\end{equation*}
<p>由于 $\ep$ 是无穷小量, 可以把 $O(\ep^2)$ 近似为 $0$, 得到一个线性方程, 求解得到</p>
\begin{equation*}
\ep\approx\dfrac{P(x_k)}{P'(x_k)},\end{equation*}
<p>于是得到迭代公式</p>
\begin{equation*}
x_{k + 1} = x_k - \dfrac{P(x_k)}{P'(x_k)}.\end{equation*}
<p>有了 Newton 法的思想后, 可以直接应用到 \eqref{equ:fpxEqu0}, 只需要把 $P(x)$ 替换成 $f’(x)$.</p>
<h2 id="算法-可靠性及有效性"><a href="#算法-可靠性及有效性" class="headerlink" title="算法, 可靠性及有效性"></a>算法, 可靠性及有效性</h2><p><strong>算法 2.1 (一维问题 Newton 法)</strong></p>
<p>Step 1. 给定 $\ep &gt; 0$ 作为精度要求 (终止条件). 取 $k = 0$ 及 $x_0$.</p>
<p>Step 2. 计算 $f’(x_k)$ 及 $f^{\prime\prime}(x_k)$.</p>
<p>Step 3. $x_{k + 1} = x_k - \dfrac{f’(x_k)}{f^{\prime\prime}(x_k)}$.</p>
<p>Step 4. 若 $\lrv{f’(x_{k + 1})} &lt; \ep$ 则停止, 输出 $x^* = x_{k + 1}$.</p>
<p>否则, 取 $x_k = x_{k + 1}$, $k = k + 1$, 进入 Step 2.</p>
<p>需要对这个算法给出相应的数学分析.</p>
<ul>
<li><p>可靠性: 是否 $x_k \to x^*$, $k \to \infty$?</p>
</li>
<li><p>有效性: $\lrv{x_k - x^*}$ 收敛到 $0$ 的速度 (作为 $k$ 的函数)?</p>
</li>
</ul>
<p><strong>定理 2.1</strong> 设 $f \in C^2$, $f’(x^*) = 0$, $f^{\prime\prime}(x^*) \neq 0$. $\lrb{x_k}$ 是算法 2.1 产生的序列, 则当 $x_0$ 充分靠近 $x^*$ 时, 有</p>
<ul>
<li><p>$\displaystyle\lim_{k \to \infty} x_k = x^*$;</p>
</li>
<li><p>$\displaystyle\lim_{k \to \infty} \dfrac{\lrv{x_{k + 1} - x^*}}{\lrv{x_k - x^*}} = 0$;</p>
</li>
<li><p>特别地, 若 $f \in C^3$, 则 $\lrv{x_{k + 1} - x^*} = O\left(\lrv{x_k - x^*}^2\right)$.</p>
</li>
</ul>
<p><strong>证明</strong></p>
<p>\begin{align*}<br>x_{k + 1} - x^* &amp;= x_k - \dfrac{f’(x_k)}{f^{\prime\prime}(x_k)} - x^*\\<br>&amp;= x_k - x^* - \dfrac{f’(x_k)}{f^{\prime\prime}(x_k)}\\<br>&amp;= x_k - x^* - \dfrac{\displaystyle\int_{x^*}^{x_k} f^{\prime\prime}(x)\di x}{f^{\prime\prime}(x_k)}\\<br>&amp;= \dfrac{1}{f^{\prime\prime}(x_k)}\left( \int_{x^*}^{x_k} \left( f^{\prime\prime}(x_k) - f^{\prime\prime}(x) \right) \di x\right),<br>\end{align*}</p>
<p>因为 $f \in C^2$ 且 $f^{\prime\prime}(x^*) \neq 0$, 所以存在 $\de &gt; 0$, $x, y \in (x^* - \de, x^* + \de)$ 时, 有</p>
\begin{equation*}
\lrv{f^{\prime\prime}(x) - f^{\prime\prime}(y)} \leqslant \dfrac{1}{2}\lrv{f^{\prime\prime}(x)},\end{equation*}
<p>进而</p>
\begin{equation*}
\lrv{x_{k + 1} - x^*} \leqslant \dfrac{1}{2}\lrv{x_{k} - x^*},\end{equation*}
<p>第一个结论得证.<span style="float:right;">$\square$</span></p>
<p><strong>习题 2.1</strong> 证明定理 2.1 的后两个结论.</p>
<p><strong>证明</strong> 由 Taylor 公式可得</p>
\begin{equation*}
0 = f'(x^*) = f'(x_k) + f^{\prime\prime}(x_k)(x^* - x_k) + o(\lrv{x^* - x_k}),\end{equation*}
<p>于是</p>
\begin{equation*}
x_{k + 1} - x^* = x_k - \dfrac{f'(x_k)}{f^{\prime\prime}(x_k)} - x^* = -\dfrac{f'(x_k) + f^{\prime\prime}(x_k)(x^* - x_k)}{f^{\prime\prime}(x_k)} = o(\lrv{x^* - x_k}).\end{equation*}
<p>由 Taylor 公式可得</p>
\begin{equation*}
0 = f'(x^*) = f'(x_k) + f^{\prime\prime}(x_k)(x^* - x_k) + \dfrac{1}{2}f^{\prime\prime\prime}(x_k)(x^* - x_k)^2 + o(\lrv{x^* - x_k}^2),\end{equation*}
<p>于是</p>
\begin{equation*}
0 = \dfrac{f'(x_k)}{f^{\prime\prime}(x_k)} + x^* - x_k + \dfrac{f^{\prime\prime\prime}(x_k)}{2f^{\prime\prime}(x_k)}(x^* - x_k)^2 + o(\lrv{x^* - x_k}^2),\end{equation*}
<p>进而</p>
\begin{equation*}
\dfrac{x_{k + 1} - x^*}{\left(x^* - x_k\right)^2} = \dfrac{f^{\prime\prime\prime}(x_k)}{2f^{\prime\prime}(x_k)} + o(1) = O(1),\end{equation*}
<p>故 $\lrv{x_{k + 1} - x^*} = O\left(\lrv{x_k - x^*}^2\right)$.<span style="float:right;">$\square$</span></p>
<p><strong>定义 2.1</strong> 记 $e_k = \lrvv{x_k - x^*}$, 取</p>
\begin{equation*}
Q_p := \limsup_{k\to\infty} \dfrac{e_{k + 1}}{e_{k}^p},\quad p > 0.\end{equation*}
<ul>
<li><p>若 $0 &lt; Q_1 &lt; 1$, 则称 $x_k$ 是<strong>线性收敛</strong>的.</p>
</li>
<li><p>若 $Q_1 = 0$, 则称 $x_k$ 是<strong>超线性收敛</strong>的.</p>
</li>
<li><p>若 $p &gt; 1$ 且 $0 &lt; Q_p &lt; \infty$, 则称 $x_k$ 是 <strong>$p$ 阶收敛</strong>的.</p>
</li>
<li><p>Newton 法是超线性收敛的. 若 $f \in C^3$, 则 Newton 法是二阶收敛的.</p>
</li>
</ul>
<p><strong>习题 2.2</strong> 假定 $\lrvv{x_0 - x^*} = 3 \times 10^{-3}$, 设两个算法收敛速度分别为</p>
\begin{equation*}
\dfrac{\lrvv{x_{k + 1} - x^*}}{\lrvv{x_{k} - x^*}} = \dfrac{1}{2},\quad \dfrac{\lrvv{x_{k + 1} - x^*}}{\lrvv{x_{k} - x^*}^2} = \dfrac{1}{2},\end{equation*}
<p>若需要达到 $\lrvv{x_{k} - x^*} \leqslant 10^{-9}$, 则两个算法分别需要多少次迭代?</p>
<p><strong>解</strong> 对于第一种算法有</p>
\begin{equation*}
\dfrac{1}{2^k} = \dfrac{\lrvv{x_{k} - x^*}}{\lrvv{x_{0} - x^*}} \leqslant \dfrac{10^{-9}}{3 \times 10^{-3}},\end{equation*}
<p>解得 $k \geqslant \log_2 3 \times 10^6 \approx 21.5165$, 至少 $22$ 次迭代.</p>
<p>对于第二种算法有<br>\begin{align*}<br>\lrvv{x_{1} - x^*} &amp;= \dfrac{1}{2}\lrvv{x_{0} - x^*}^{2} = 4.5 \times 10^{-6} &gt; 10^{-9},\\<br>\lrvv{x_{2} - x^*} &amp;= \dfrac{1}{2}\lrvv{x_{1} - x^*}^{2} = 1.0125 \times 10^{-11} &lt; 10^{-9},<br>\end{align*}</p>
<p>所以至少 $2$ 次迭代.<span style="float:right;">$\square$</span></p>
<h1 id="割线法"><a href="#割线法" class="headerlink" title="割线法"></a>割线法</h1><p>割线法的思想和 Newton 法非常相似, 它甚至可以看成是 Newton 法的一种近似. Newton 法的核心是迭代公式</p>
\begin{equation*}
x_{k + 1} = x_k - \dfrac{f'(x_k)}{f^{\prime\prime}(x_k)},\end{equation*}
<p>但实际计算中由于 $f$ 的光滑性或者计算复杂度的问题, 我们经常希望避免二阶导数的计算.</p>
<p>想法: 用差商来近似 (替代) 求导运算, 即</p>
\begin{equation*}
f^{\prime\prime}(x_k) \approx \dfrac{f'(x_k) - f'(x_{k - 1})}{x_k - x_{k - 1}},\end{equation*}
<p>代入 Newton 法中, 得到</p>
\begin{equation*}
x_{k + 1} = x_k - \dfrac{f'(x_k)}{\dfrac{f'(x_k) - f'(x_{k - 1})}{x_k - x_{k - 1}}}.\end{equation*}
<p><strong>算法 2.2 (一维优化问题割线法)</strong></p>
<p>Step 1. 给定 $\ep &gt; 0$, 初始值 $x_0$, $x_1$, 令 $k = 1$, 计算 $f’(x_{k - 1})$.</p>
<p>Step 2. 计算 $f’(x_k)$.</p>
<p>Step 3. 若 $\lrv{f’(x_k)} &lt; \ep$ 则停止, 输出 $x^* = x_k$, 否则计算</p>
\begin{equation*}
x_{k + 1} = x_k - \dfrac{f'(x_k)(x_k - x_{k - 1})}{f'(x_k) - f'(x_{k - 1})},\end{equation*}
<p>令 $k = k + 1$, 进入 Step 2.</p>
<p>下面通过数学分析来看割线法的可靠性与有效性.</p>
<p><strong>定理 2.2</strong> 设 $f \in C^3$, $f’(x^*) = 0$, $f^{\prime\prime}(x^*) \neq 0$, 则当 $x_1$, $x_2$ 充分靠近 $x^*$ 时, 算法 2.2 产生的序列 $\lrb{x_k}$ 满足</p>
\begin{equation*}
\lim_{k \to \infty} \dfrac{\lrvv{x_{k + 1} - x^*}}{\lrvv{x_{k + 1} - x^*}^\tau} = \lrvv{\dfrac{f^{\prime\prime\prime}(x^*)}{2f^{\prime\prime}(x^*)}}^\frac{1}{\tau},\quad \text{其中}~\tau = \dfrac{\sqrt{5} + 1}{2} < 2.\end{equation*}
<p><strong>证明</strong> <span style="color: red"><strong>(这个证明我感觉有问题, 主要是 Peano 余项那部分估计)</strong></span> 作差<br>\begin{align}<br>x_{k + 1} - x^* &amp;= x_k - \dfrac{f’(x_k)(x_k - x_{k - 1})}{f’(x_k) - f’(x_{k - 1})} - x^*\nonumber\\<br>&amp;= \dfrac{1}{f’(x_k) - f’(x_{k - 1})}\left( f’(x_k)(x_{k - 1} - x^*) - f’(x_{k - 1})(x_{k} - x^*) \right),\label{equ:xkp1xs}<br>\end{align}</p>
<p>由 $f \in C^3$, 利用带 Peano 余项的 Taylor 展开<br>\begin{align*}<br>f’(x_k) &amp;= f’(x^*) + f^{\prime\prime}(x^*)(x_k - x^*) + \dfrac{1}{2}f^{\prime\prime\prime}(x^*)(x_k - x^*)^2 + o\left( \lrv{x_k - x^*}^2 \right),\\<br>f’(x_{k - 1}) &amp;= f’(x^*) + f^{\prime\prime}(x^*)(x_{k - 1} - x^*) + \dfrac{1}{2}f^{\prime\prime\prime}(x^*)(x_{k - 1} - x^*)^2 + o\left( \lrv{x_{k - 1} - x^*}^2 \right),<br>\end{align*}</p>
<p>代回 \eqref{equ:xkp1xs} 式得 (第一项由于 $f’(x^*) = 0$ 消失, 第二项由于抵消消失)<br>\begin{align}<br>x_{k + 1} - x^* =&amp; \dfrac{1}{f’(x_k) - f’(x_{k - 1})} \left( \dfrac{f^{\prime\prime\prime}(x^*)}{2}(x_k - x^*)(x_{k - 1} - x^*)(x_k - x_{k - 1}) \right)\nonumber\\<br>&amp;+ \dfrac{1}{f’(x_k) - f’(x_{k - 1})} \left( (x_{k - 1} - x^*) o\left( \lrv{x_k - x^*}^2 \right)\right.\nonumber\\<br>&amp;\quad\quad\quad\quad\quad\quad\quad\quad\quad -\left. (x_k - x^*) o\left( \lrv{x_{k - 1} - x^*}^2 \right) \right)\nonumber\\<br>=&amp;: T_1 + T_2\quad (\text{两项分别记为}~T_1~\text{与}~T_2).\label{equ:T1T2}<br>\end{align}</p>
<p>对于 $T_1$, 由中值定理可得</p>
\begin{equation*}
f'(x_k) - f'(x_{k - 1}) = \left( f^{\prime\prime}(x^*) + o(1) \right)(x_k - x_{k - 1}),\end{equation*}
<p>代入可得</p>
\begin{equation*}
T_1 = \dfrac{f^{\prime\prime\prime}(x^*)}{2}(x_k - x^*)(x_{k - 1} - x^*)\dfrac{1}{f^{\prime\prime}(x^*) + o(1)}.\end{equation*}
<p>由</p>
\begin{equation*}
\dfrac{1}{f^{\prime\prime}(x^*)} - \dfrac{1}{f^{\prime\prime}(x^*) + o(1)} = \dfrac{o(1)}{f^{\prime\prime}(x^*)\left( f^{\prime\prime}(x^*) + o(1) \right)}\end{equation*}
<p>有</p>
\begin{equation*}
T_1 = \dfrac{f^{\prime\prime\prime}(x^*)}{2f^{\prime\prime}(x^*)}(x_k - x^*)(x_{k - 1} - x^*) + o\left( \lrv{x_k - x^*}\lrv{x_{k - 1} - x^*} \right).\end{equation*}
<p>对于 $T_2$, 记 $e_k = x_k - x^*$, $r_k = r(e_k)$ 为 Peano 余项, 它是 $e_k$ 的函数, 有<br>\begin{equation}\label{equ:rxx2}<br>\displaystyle\lim_{x \to 0}\dfrac{r(x)}{x^2} = 0,<br>\end{equation}</p>
<p>及<br>\begin{align*}<br>T_2 &amp;= \dfrac{1}{f’(x_k) - f’(x_{k - 1})}\left( e_{k - 1}r_k - e_kr_{k - 1} \right)\\<br>&amp;= \dfrac{1}{f^{\prime\prime}(\tilde{x})(x_k - x_{k - 1})} e_{k - 1}e_k\left( \dfrac{r_k}{e_k} - \dfrac{r_{k - 1}}{e_{k - 1}} \right)\quad \text{其中}~\tilde{x} \in (x_{k - 1}, x_k)\\<br>&amp;= \dfrac{1}{f^{\prime\prime}(\tilde{x})}\dfrac{e_{k - 1}e_k}{e_k - e_{k - 1}}\left( \dfrac{r_k}{e_k} - \dfrac{r_{k - 1}}{e_{k - 1}} \right).<br>\end{align*}</p>
<p>记 $g(x) = \dfrac{r(x)}{x}$, 由 \eqref{equ:rxx2} 式可得 $\displaystyle\lim_{x \to 0} g’(x) = 0$, 于是<br>\begin{align*}<br>\lim_{k \to \infty}\dfrac{T_2}{e_ke_{k - 1}} &amp;= \lim_{k \to \infty} \dfrac{1}{f^{\prime\prime}(\tilde{x})} \dfrac{1}{e_k - e_{k - 1}}\left( \dfrac{r_k}{e_k} - \dfrac{r_{k - 1}}{e_{k - 1}} \right)\\<br>&amp;= \lim_{k \to \infty} \dfrac{1}{f^{\prime\prime}(\tilde{x})} \dfrac{1}{e_k - e_{k - 1}} g’(\tilde{e})\left( e_k - e_{k - 1}\right)\quad \text{其中}~\tilde{e} \in (e_{k - 1}, e_k)\\<br>&amp; = 0.<br>\end{align*}</p>
<p>故 $T_2 = o(e_k e_{k - 1})$. 由 \eqref{equ:T1T2} 式结合 $T_1$ 与 $T_2$ 的估计可得</p>
\begin{equation*}
x_{k + 1} - x^* = \dfrac{f^{\prime\prime\prime}(x^*)}{2f^{\prime\prime}(x^*)}(x_k - x^*)(x_{k - 1} - x^*) + o\left( \lrv{x_k - x^*}\lrv{x_{k - 1} - x^*} \right),\end{equation*}
<p>所以 $x_k \to x^*$, $k \to \infty$, 进而使用以下引理即可证得定理结论.<span style="float:right;">$\square$</span></p>
<p><strong>引理 2.1</strong> 设 $e_k &gt; 0$ 且 $\displaystyle\lim_{k \to \infty} e_k = 0$, 若 $e_{k + 1} = \beta_k e_k e_{k - 1}$, 其中 $\beta_k \to \beta^* &gt; 0$, 则</p>
\begin{equation*}
\lim_{k \to \infty} \dfrac{e_{k + 1}}{e_k^\tau} = \left(\beta^* \right)^\frac{1}{\tau},\quad \tau = \dfrac{\sqrt{5} + 1}{2}.\end{equation*}
<p><strong>习题 2.3</strong> 证明上述引理. 提示: $\ln e_{k + 1} = \ln e_k + \ln e_{k - 1} + \ln \beta_k$, 利用 $\tau^2 = \tau + 1$, 有</p>
\begin{equation*}
\ln e_{k + 1} - \tau \ln e_k = -\dfrac{1}{\tau} \left( \ln e_k - \tau \ln e_{k - 1} \right) + \ln \beta_k.\end{equation*}
<p><strong>证明</strong> 利用提示内容, 有</p>
\begin{equation*}
\ln e_{k + 1} - \tau \ln e_k - \dfrac{1}{\tau}\ln\ba_k = -\dfrac{1}{\tau} \left( \ln e_k - \tau \ln e_{k - 1} - \dfrac{1}{\tau}\ln\ba_{k - 1} \right) + \dfrac{\ln \beta_k - \ln \ba_{k - 1}}{\tau^2}.\end{equation*}
<p>令</p>
\begin{equation*}
a_k = \ln e_{k + 1} - \tau \ln e_k - \dfrac{1}{\tau}\ln\ba_k,\quad b_{k - 1} = \dfrac{\ln \beta_{k} - \ln \ba_{k - 1}}{\tau^2},\end{equation*}
<p>有<br>\begin{align*}<br>a_k &amp;= -\dfrac{1}{\tau}a_{k - 1} + b_{k - 1}\\<br>&amp;= -\dfrac{1}{\tau}\left( -\dfrac{1}{\tau}a_{k - 2} + b_{k - 2} \right) + b_{k - 1}\\<br>&amp;=\dfrac{a_1}{(-\tau)^{k - 1}} + \left( b_{k - 1} - \dfrac{1}{\tau}b_{k - 2} + \dfrac{1}{\tau^2}b_{k - 3} + \cdots + \dfrac{1}{(-\tau)^{k - 2}}b_{1} \right)\\<br>&amp;=: x_{k - 1} + y_{k - 1}.<br>\end{align*}</p>
<p>由 $\displaystyle\lim_{k \to \infty} b_k = 0$, 对于任意 $\ep &gt; 0$, 存在 $N \in \N$, $n &gt; N$ 时, $\lrv{b_k} &lt; \ep$. 令 $M = \lrb{\lrv{b_1}, \lrv{b_2}, \cdots, \lrv{b_N}}$, 有<br>\begin{align*}<br>\lrv{y_{k - 1}} &amp;= \lrv{b_{k - 1} - \dfrac{1}{\tau}b_{k - 2} + \cdots + \dfrac{1}{(-\tau)^{k - 1 - N}}b_N + \cdots + \dfrac{1}{(-\tau)^{k - 2}}b_{1}}\\<br>&amp;\leqslant \left( 1 + \dfrac{1}{\tau} + \cdots + \dfrac{1}{\tau^{k - 1 - N}} \right)\ep + \left( \dfrac{1}{\tau^{k - N}} + \cdots + \dfrac{1}{\tau^{k - 2}} \right) M\\<br>&amp;&lt; \left( \sum_{i = 0}^{\infty} \dfrac{1}{\tau^i} \right)\ep + \left( \sum_{i = k - N}^{\infty} \dfrac{1}{\tau^i} \right)M\\<br>&amp;= \dfrac{1}{1 + \tau}\ep + \left( \sum_{i = k - N}^{\infty} \dfrac{1}{\tau^i} \right)M,<br>\end{align*}</p>
<p>令 $k \to \infty$, 有</p>
\begin{equation*}
\lim_{k \to \infty} \lrv{y_{k - 1}} < \dfrac{1}{1 + \tau}\ep,\end{equation*}
<p>由 $\ep$ 的任意性知 $\displaystyle\lim_{k \to \infty} y_{k - 1} = 0$. 显然有 $\displaystyle\lim_{k \to \infty} x_{k - 1} = 0$, 因此 $\displaystyle\lim_{k \to \infty} a_{k} = 0$, 进而有</p>
\begin{equation*}
\lim_{k \to \infty} \ln e_{k + 1} - \tau \ln e_k = \lim_{k \to \infty} \dfrac{1}{\tau}\ln\ba_k = \dfrac{1}{\tau} \ln \ba^*,\end{equation*}
<p>所以<br>\begin{align*}<br>\lim_{k \to \infty} \dfrac{e_{k + 1}}{e_k^\tau} = \left(\beta^* \right)^\frac{1}{\tau}.\tag*{$\square$}<br>\end{align*}</p>
<h1 id="两种方法统一的刻画"><a href="#两种方法统一的刻画" class="headerlink" title="两种方法统一的刻画"></a>两种方法统一的刻画</h1><p>前面两种方法都可以用以下的方式刻画.</p>
<p>考虑 \eqref{equ:fpxEqu0} 式, 要得到 $x^*$, 从 $x_k$ 出发, 构造一个线性函数 $\eta_k(x)$ 逼近 $f’(x)$, 然后求解 $\eta_k(x_{k + 1}) = 0$, 得到近似值 $x^* = x_{k + 1}$.</p>
<p>回到 \eqref{equ:notResOneOpt} 式上, 同样地从 $x_k$ 出发, 构造一个二次函数 $\p_k(x)$ 逼近 $f(x)$, 然后求解 $\displaystyle\min_{x \in \R} \p_k(x)$ 的极小 $x_{k + 1}$, 得到近似值 $x^* = x_{k + 1}$.</p>
<p>前面所述的两种方法构造的二次函数为<br>\begin{equation}\label{equ:pkx}<br>\p_k(x) = f(x_k) + f’(x_k)(x - x_k) + \dfrac{1}{2} c_k(x - x_k)^2,<br>\end{equation}</p>
<p>满足条件</p>
\begin{equation*}
\p_k(x_k) = f(x_k),\quad \p'_k(x_k) = f'(x_k),\end{equation*}
<p>要求出 $c_k$ 还需要增加条件.</p>
<p>对于 Newton 方法, 增加的条件为 $\p_k^{\prime\prime}(x_k) = f^{\prime\prime}(x_k)$, 解得 $c_k = f^{\prime\prime}(x_k)$, 进而 $x_{k + 1} = x_k - \dfrac{f’(x_k)}{f^{\prime\prime}(x_k)}$.</p>
<p>对于割线法, 增加的条件为 $\p’_k(x_{k - 1}) = f’(x_{k - 1})$, 解得 $c_k = \dfrac{f’(x_k) - f’(x_{k - 1})}{x_k - x_{k - 1}}$, 进而 $x_{k + 1} = x_k - \dfrac{f’(x_k)(x_k - x_{k - 1})}{f’(x_k) - f’(x_{k - 1})}$.</p>
<p><strong>习题 2.4</strong> 若增加的条件为 $\p_k(x_{k - 1}) = f(x_{k - 1})$, 计算 $c_k$, 并进一步写出算法的迭代公式.</p>
<p>将 $\p_k(x_{k - 1}) = f(x_{k - 1})$ 代入 \eqref{equ:pkx} 式, 解得</p>
\begin{equation*}
c_k = \dfrac{2\left( f(x_{k - 1}) - f(x_k) -f'(x_k)(x_{k - 1} - x_k)\right)}{(x_{k - 1} - x_k)^2}.\end{equation*}
<p>$\p_k(x)$ 的极小值点满足</p>
\begin{equation*}
x - x_k = -\dfrac{f'(x_k)} {c_k},\end{equation*}
<p>故迭代公式为<br>\begin{align*}<br>x_{k + 1} = x_k - \dfrac{f’(x_k)(x_{k - 1} - x_k)^2}{2\left( f(x_{k - 1}) - f(x_k) -f’(x_k)(x_{k - 1} - x_k)\right)}.\tag*{$\square$}<br>\end{align*}</p>
<p><strong>程序 1</strong> 求解 $\displaystyle\min_{x \in \R} -x\e^{-x}$, 已知 $x^* = 1$, 编制 Newton 法和割线法的程序来求解并进行比较, 初值选取为:</p>
<ul>
<li>Newton 法: $x_0 = 0$;</li>
<li>割线法: $x_0 = 0$, $x_1 = 0.5$.</li>
</ul>
<p><strong>解</strong> 取 $\ep = 2^{-52}$ (即 MATLAB 的浮点相对精度), 代码如下.</p>
<pre><code class="lang-MATLAB">clear, clc, close all;
syms x
f(x) = -x .* exp(-x);
x0 = 0;
x1 = 0.5;
varepsilon = eps;
df = diff(f);
ddf = diff(df);
%% Newton 法

x = x0;

while true
    xk = x(end);
    x = [x; double(xk - df(xk) ./ ddf(xk))];
    if abs(df(x(end))) &lt; varepsilon
        break;
    end
end
%% 割线法

y = [x0; x1];

while true
    xk = y(end);
    dfxk = df(xk);
    if abs(dfxk) &lt; varepsilon
        break;
    end
    y = [y; double(xk - dfxk .* (xk - y(end - 1)) ./ (dfxk - df(y(end - 1))))];
end
%% 比较

figure;
plot(0 : (size(x, 1) - 1), abs(1 - x), 0 : (size(y, 1) - 1), abs(1 - y)), ...
    xlabel(&#39;迭代次数&#39;, &#39;FontName&#39;, &#39;微软雅黑&#39;), ...
    ylabel(&#39;误差&#39;, &#39;FontName&#39;, &#39;微软雅黑&#39;), ...
    legend(&#39;Newton 法&#39;, &#39;割线法&#39;, &#39;FontName&#39;, &#39;微软雅黑&#39;);
format long;
disp(x);
disp(x - 1);
disp(abs(x(2 : end) - 1) ./ abs(x(1 : (end - 1)) - 1) .^ 2);
disp(y);
disp(y - 1);
disp(abs(y(2 : end) - 1) ./ abs(y(1 : (end - 1)) - 1) .^ ((sqrt(5) + 1) ./ 2));
</code></pre>
<p>运行结果如下. 注意到 Newton 法的 $\dfrac{\lrv{x_k - x^*}}{\lrv{x_{k - 1} - x^*}^2}$ 与割线法的 $\dfrac{\lrv{x_k - x^*}}{\lrv{x_{k - 1} - x^*}^\tau}$ 都趋近于 $\lrv{\dfrac{f^{\prime\prime\prime}(x^*)}{2f^{\prime\prime}(x^*)}} = 1$.</p>
<p><img src="/img/OptimizationTheory/Program1.svg" srcset="/img/loading.gif" title="两种方法的误差比较" alt="两种方法的误差比较"></p>
<style>
table {
    display: table!important;
}
</style>

<div style="text-align:center">Newton 法</div>

<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">$x_k$</th>
<th style="text-align:center">$x_k - x^*$</th>
<th style="text-align:center">$\dfrac{\lrv{x_k - x^*}}{\lrv{x_{k - 1} - x^*}^2}$</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">$0$</td>
<td style="text-align:center">$-1.000000000000000$</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">$0.500000000000000$</td>
<td style="text-align:center">$-0.500000000000000$</td>
<td style="text-align:center">$0.500000000000000$</td>
</tr>
<tr>
<td style="text-align:center">$0.833333333333333$</td>
<td style="text-align:center">$-0.166666666666667$</td>
<td style="text-align:center">$0.666666666666667$</td>
</tr>
<tr>
<td style="text-align:center">$0.976190476190476$</td>
<td style="text-align:center">$-0.023809523809524$</td>
<td style="text-align:center">$0.857142857142858$</td>
</tr>
<tr>
<td style="text-align:center">$0.999446290143965$</td>
<td style="text-align:center">$-0.000553709856035$</td>
<td style="text-align:center">$0.976744186046483$</td>
</tr>
<tr>
<td style="text-align:center">$0.999999693575066$</td>
<td style="text-align:center">$-0.000000306424934$</td>
<td style="text-align:center">$0.999446596698782$</td>
</tr>
<tr>
<td style="text-align:center">$0.999999999999906$</td>
<td style="text-align:center">$-0.000000000000094$</td>
<td style="text-align:center">$1.000304885275709$</td>
</tr>
<tr>
<td style="text-align:center">$1.000000000000000$</td>
<td style="text-align:center">$0$</td>
<td style="text-align:center">$0$</td>
</tr>
</tbody>
</table>
</div>
<p><br></p>
<div style="text-align:center">割线法</div>

<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">$x_k$</th>
<th style="text-align:center">$x_k - x^*$</th>
<th style="text-align:center">$\dfrac{\lrv{x_k - x^*}}{\lrv{x_{k - 1} - x^*}^\tau}$</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">$0$</td>
<td style="text-align:center">$-1.000000000000000$</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">$0.500000000000000$</td>
<td style="text-align:center">$-0.500000000000000$</td>
<td style="text-align:center">$0.500000000000000$</td>
</tr>
<tr>
<td style="text-align:center">$0.717633299196792$</td>
<td style="text-align:center">$-0.282366700803208$</td>
<td style="text-align:center">$0.866742802928595$</td>
</tr>
<tr>
<td style="text-align:center">$0.898802528965495$</td>
<td style="text-align:center">$-0.101197471034505$</td>
<td style="text-align:center">$0.783018667120379$</td>
</tr>
<tr>
<td style="text-align:center">$0.976078343656424$</td>
<td style="text-align:center">$-0.023921656343576$</td>
<td style="text-align:center">$0.973779328626748$</td>
</tr>
<tr>
<td style="text-align:center">$0.997722783634153$</td>
<td style="text-align:center">$-0.002277216365847$</td>
<td style="text-align:center">$0.956258176135382$</td>
</tr>
<tr>
<td style="text-align:center">$0.999946231646904$</td>
<td style="text-align:center">$-0.000053768353096$</td>
<td style="text-align:center">$1.014697058670582$</td>
</tr>
<tr>
<td style="text-align:center">$0.999999877700416$</td>
<td style="text-align:center">$-0.000000122299584$</td>
<td style="text-align:center">$0.989869260031477$</td>
</tr>
<tr>
<td style="text-align:center">$0.999999999993424$</td>
<td style="text-align:center">$-0.000000000006576$</td>
<td style="text-align:center">$1.006279510682946$</td>
</tr>
<tr>
<td style="text-align:center">$1.000000000000000$</td>
<td style="text-align:center">$0$</td>
<td style="text-align:center">$0$</td>
</tr>
</tbody>
</table>
</div>
<h1 id="抛物线法"><a href="#抛物线法" class="headerlink" title="抛物线法"></a>抛物线法</h1><p>若 $\p_k(x) = ax^2 + bx + c$ 满足</p>
<p>\begin{equation}\begin{cases}\begin{aligned}<br>\p_k(x_k) &amp;= f(x_k),\\<br>\p_k(x_{k - 1}) &amp;= f(x_{k - 1}),\\<br>\p_k(x_{k - 2}) &amp;= f(x_{k - 2}),<br>\end{aligned}\end{cases}\label{equ:kk-1k-2}\end{equation}</p>
<p>则可以求出 $x_{k + 1} = \underset{x \in \R}{\mathrm{argmin}} \p_k(x)$ 来逼近 $x^*$.</p>
<p>为了求解 \eqref{equ:kk-1k-2} 式, 可以利用 Lagrange 插值公式, 有</p>
<p>\begin{align*}<br>\p_k(x) &amp;= f(x_{k - 2}) \dfrac{(x - x_{k - 1})(x - x_k)}{(x_{k - 2} - x_{k - 1})(x_{k - 2} - x_k)}\\<br>&amp;\quad + f(x_{k - 1}) \dfrac{(x - x_{k - 2})(x - x_k)}{(x_{k - 1} - x_{k - 2})(x_{k - 1} - x_k)}\\<br>&amp;\quad + f(x_{k}) \dfrac{(x - x_{k - 1})(x - x_{k - 2})}{(x_{k} - x_{k - 1})(x_{k} - x_{k - 2})}<br>\end{align*}</p>
<p><strong>习题 2.5</strong> 写出抛物线法的迭代公式, 进一步写出相应的算法. 注意:</p>
<ul>
<li>每个迭代步只需算一次函数值;</li>
<li>如何选点进入新的迭代.</li>
</ul>
<p><strong>解</strong> Lagrange 插值得到的公式为<br>\begin{align*}<br>\p_k(x) &amp;= \dfrac{f(x_{k - 2})(x_k - x_{k - 1}) + f(x_{k - 1})(x_{k - 2} - x_k) + f(x_{k})(x_{k - 1} - x_{k - 2})}{(x_{k - 2} - x_{k - 1})(x_{k - 1} - x_k)(x_k - x_{k - 2})} x^2\\<br>&amp;\quad + \dfrac{f(x_{k - 2})(x_{k - 1}^2 - x_k^2) + f(x_{k - 1})(x_k^2 - x_{k - 2}^2) + f(x_{k})(x_{k - 2}^2 - x_{k - 1}^2)}{(x_{k - 2} - x_{k - 1})(x_{k - 1} - x_k)(x_k - x_{k - 2})} x + c,<br>\end{align*}<br>最小值点即迭代公式为<br>\begin{equation}\label{equ:xkp1}<br>x_{k + 1} = \dfrac{f(x_{k - 2})(x_{k - 1}^2 - x_k^2) + f(x_{k - 1})(x_k^2 - x_{k - 2}^2) + f(x_{k})(x_{k - 2}^2 - x_{k - 1}^2)}{2(f(x_{k - 2})(x_{k - 1} - x_k) + f(x_{k - 1})(x_k - x_{k - 2}) + f(x_{k})(x_{k - 2} - x_{k - 1}))}.<br>\end{equation}<br>具体算法如下.</p>
<p>Step 1. 给定 $\ep &gt; 0$, 初始值 $x_0 &lt; x_1 &lt; x_2$, 使得 $f(x_1) &lt; f(x_0)$, $f(x_1) &lt; f(x_2)$ (可用进退法确定: 给定 $x_0$, 步长 $h$, $\lambda = 1$, 若 $f(x_0) &gt; f(x_1)$, 则 $x_2 = x_1 + \lambda h$, 不断扩大 $\lambda$ 使得 $f(x_2) &gt; f(x_1)$, 若 $f(x_0) \leqslant f(x_1)$, 则 $x_2 = x_1 - \lambda h$, 不断扩大 $\lambda$ 使得 $f(x_2) &gt; f(x_0)$).</p>
<p>Step 2. 若 $\lrv{x_2 - x_0} &lt; \ep$, 则停止, 输出 $x^* = x_1$, 否则进入 Step 3.</p>
<p>Step 3. 利用 \eqref{equ:xkp1} 式计算 $x_3$, 若 $f(x_3) &lt; f(x_1)$, 则进入 Step 4, 否则进入 Step 5.</p>
<p>Step 4. 若 $x_3 &lt; x_1$, 则令 $x_2 = x_1$, 否则令 $x_0 = x_1$. 然后令 $x_1 = x_3$, 进入 Step 2.</p>
<p>Step 5. 若 $x_3 &lt; x_1$ 则令 $x_0 = x_3$, 否则令 $x_2 = x_3$. 然后进入 Step 2.<span style="float:right;">$\square$</span></p>
<h1 id="二分法"><a href="#二分法" class="headerlink" title="二分法"></a>二分法</h1><p>要求解 $f’(x^*) = 0$, 可以通过迭代试探点来分割并缩小搜索区间, 目标:</p>
<ul>
<li>极小点始终在搜索区间内;</li>
<li>区间缩小的速率尽可能快.</li>
</ul>
<p><strong>定理 2.3 (根存在定理)</strong> 若 $f’(a)f’(b) &lt; 0$, 则 $f’(x) = 0$ 在 $(a, b)$ 内一定存在根.</p>
<p>根据定理 2.3, 选取区间的办法如下.</p>
<ul>
<li>若 $f’(a)f’(c) &lt; 0$, 则选取 $[a’, b’] = [a, c]$.</li>
<li>若 $f’(b)f’(c) &lt; 0$, 则选取 $[a’, b’] = [c, b]$.</li>
</ul>
<p>考虑最坏的情况, 有</p>
\begin{equation*}
\min\dfrac{\lrv{a' - b'}}{\lrv{a - b}} = \min_{c \in (a, b)}\dfrac{\max \lrb{\lrv{a - c}, \lrv{b - c}}}{\lrv{a - b}} = \dfrac{1}{2},\end{equation*}
<p>即选取 $c = \dfrac{1}{2}(a + b)$ 可使收敛速度最快, 此时每次区间缩小到原来的 $\dfrac{1}{2}$, 为线性收敛的算法.</p>
<p><strong>练习</strong> 写出二分法的算法.</p>
<h1 id="Fibonacci-法"><a href="#Fibonacci-法" class="headerlink" title="Fibonacci 法"></a>Fibonacci 法</h1><p>首先定义一个区间上的单峰函数.</p>
<p><strong>定义 2.2 (单峰函数)</strong> $f \in C([a, b])$, 若 $x^* \in [a, b]$ 使得 $f$ 在 $[a, x^*]$ 上严格单调下降, 在 $[x^*, b]$ 上严格单调上升, 则称 $f$ 是 $[a, b]$ 上的单峰函数.</p>
<p>有如下性质.</p>
<ol>
<li><p>$x^*$ 是 $f$ 在 $[a, b]$ 上的极小值点.</p>
</li>
<li><ul>
<li><p>若 $a’ \in [a, x^*]$, 则 $f$ 在 $[a’, b]$ 上是单峰函数;</p>
</li>
<li><p>若 $b’ \in [x^*, b]$, 则 $f$ 在 $[a, b’]$ 上是单峰函数.</p>
</li>
</ul>
</li>
<li><p>设 $x_1, x_2 \in [a, b]$, $x_1 &lt; x_2$.</p>
<ul>
<li><p>若 $f(x_1) &lt; f(x_2)$, 则 $x^* \in [a, x_2]$.</p>
</li>
<li><p>若 $f(x_1) &gt; f(x_2)$, 则 $x^* \in [x_1, b]$.</p>
</li>
<li><p>若 $f(x_1) &lt; f(x_2)$, 则 $x^* \in [x_1, x_2]$.</p>
</li>
</ul>
</li>
</ol>
<p>利用性质 3, 可以将 $[a, b]$ 缩小为 $[a’, b’]$:</p>
\begin{equation*}

[a', b'] = \left\{\begin{array}{ll}
[a, x_2],    &    \text{若}~f(x_1) < f(x_2),\\
[x_1, b],    &    \text{若}~f(x_1) > f(x_2),\\
[x_1, x_2],    &    \text{若}~f(x_1) = f(x_2).
\end{array}\right.\end{equation*}
<p>如何寻找试探点 $x_1$, $x_2$, 使得 $\dfrac{\lrv{a’ - b’}}{\lrv{a - b}}$ 尽可能地小?</p>
<p><strong><div style="color:red">(后面再补)</div></strong></p>
<p><strong>习题 2.6</strong> 写出完整的 Fibonacci 算法. 提示:</p>
<ul>
<li>由 $\ep$ 来决定迭代次数 $k$;</li>
<li>每一步只计算一次函数值.</li>
</ul>
<p><strong>解</strong></p>
<p>Step 1. 给定 $[a, b]$ 和 $\ep &gt; 0$, 求得 $k$ 及数列 $\lrb{F_i}_{i = 1}^k$ 使得 $F_k \geqslant \dfrac{b - a}{\ep} &gt; F_{k - 1}$.</p>
<p>令</p>
\begin{equation*}
x_1 = a + \dfrac{F_{k - 2}}{F_k}(b - a),\quad x_2 = a + \dfrac{F_{k - 1}}{F_k}(b - a),\quad n = 1,\quad f_1 = f(x_1),\quad f_2 = f(x_2).\end{equation*}
<p>Step 2. 若 $f_1 &lt; f_2$, 进入 Step 3. 若 $f_1 \geqslant f_2$, 进入 Step 4.</p>
<p>Step 3. 令</p>
\begin{equation*}
b = x_2,\quad x_2 = x_1,\quad x_1 = a + \dfrac{F_{k - 2 - n}}{F_{k - n}}(b - a),\quad f_2 = f_1,\quad f_1 = f(x_1),\end{equation*}
<p>若 $n = k - 2$ 则停止, 最小值位于 $[a, b]$, 否则 $n = n + 1$, 进入 Step 2.</p>
<p>Step 4. 令</p>
\begin{equation*}
a = x_1,\quad x_1 = x_2,\quad x_2 = a + \dfrac{F_{k - 1 - n}}{F_{k - n}}(b - a),\quad f_1 = f_2,\quad f_2 = f(x_2),\end{equation*}
<p>若 $n = k - 2$ 则停止, 最小值位于 $[a, b]$, 否则 $n = n + 1$, 进入 Step 2.<span style="float:right;">$\square$</span></p>
<ul>
<li><p>优点: 收敛快.</p>
</li>
<li><p>缺点: 不灵活, 当精度要求改变时, 需要重新开始算法.</p>
</li>
</ul>
<p>为了克服该缺点, 在 Fibonacci 法的基础上改进出黄金分割法.</p>
<h1 id="黄金分割法"><a href="#黄金分割法" class="headerlink" title="黄金分割法"></a>黄金分割法</h1><p>目标: 每一步区间缩小的比例相同.</p>
<p><strong><div style="color:red">(后面再补)</div></strong></p>
<p>经过 $k$ 步以后 $\a \geqslant \dfrac{1}{F_{k + 1}} \geqslant \a^{k + 1}$, 所以只需要多迭代一步, 算法精度就可以超过 Fibonacci 法, 同时算法更灵活.</p>
<p><strong>习题 2.7</strong> 证明 $\a^k \geqslant \dfrac{1}{F_{k + 1}} \geqslant \a^{k + 1}$. 提示: 利用 Fibonacci 数列的通项公式.</p>
<p><strong>证明</strong> 首先求出 Fibonacci 数列的通项公式. 设 $r$, $s$ 满足</p>
\begin{equation*}
F_k - rF_{k - 1} = s(F_{k - 1} - rF_{k - 2}),\end{equation*}
<p>则 $r + s = 1$, $rs = -1$, 解得</p>
\begin{equation*}
s = \dfrac{1 + \sqrt{5}}{2},\quad r = \dfrac{1 - \sqrt{5}}{2}.\end{equation*}
<p>$k \geqslant 2$ 时, 有</p>
\begin{equation*}
F_k - rF_{k - 1} = s^{k - 1}(F_{1} - rF_{0}) = s^{k - 1} = s^k,\end{equation*}
<p>进而<br>\begin{align*}<br>F_k &amp;= rF_{k - 1} + s^k\\<br>&amp;= s^k + rs^{k - 1} + r^2F_{k - 2}\\<br>&amp;= \sum_{i = 0}^k s^{k - i}r^i\\<br>&amp;= \dfrac{s^{k + 1} - r^{k + 1}}{s - r}\\<br>&amp;= \dfrac{1}{\sqrt{5}}\left(\left(\dfrac{1 + \sqrt{5}}{2}\right)^{k + 1} - \left(\dfrac{1 - \sqrt{5}}{2}\right)^{k + 1}\right)\\<br>&amp;= \dfrac{1}{\sqrt{5}}\left(\left(\dfrac{1}{\a}\right)^{k + 1} - \left(-\a\right)^{k + 1}\right),<br>\end{align*}</p>
<p>代入 $k = 0, 1$ 均成立. 于是<br>\begin{align*}<br>&amp;\a^k \geqslant \dfrac{1}{F_{k + 1}} \geqslant \a^{k + 1}\\<br>\Longleftrightarrow\quad &amp; \a^{-k} \leqslant \dfrac{1}{\sqrt{5}}\left(\left(\dfrac{1}{\a}\right)^{k + 2} - \left(-\a\right)^{k + 2}\right) \leqslant \a^{-k - 1}\\<br>\Longleftrightarrow\quad &amp; \sqrt{5}\a^2 \leqslant 1 - (-\a^2)^{k + 2} \leqslant \sqrt{5} \a,<br>\end{align*}</p>
<p>上述不等式中只有中间部分是与 $k$ 有关的, 两边都是常数, 故只需分析中间部分的极值. $k$ 为偶数时, $k = 0$ 时取得最小值, 有 $1 - \a^4 = \sqrt{5}\a^2$, 中间部分随 $k$ 的增大而增大, $k \to \infty$ 时, 有 $1 \leqslant \sqrt{5}\a$. $k$ 为奇数时, $k = 1$ 时取得最大值, 有 $1 + \a^6 \leqslant 1.0558 \leqslant 1.3819 \leqslant \sqrt{5}\a$, 中间部分随 $k$ 的增大而减小, $k \to \infty$ 时, 有 $1 \geqslant \sqrt{5}\a^2$.<span style="float:right;">$\square$</span></p>
<p>练习: 写出黄金分割法的完整算法.</p>
<h1 id="线搜索"><a href="#线搜索" class="headerlink" title="线搜索"></a>线搜索</h1>
            <hr>
          </div>
          <br>
          <div>
            <div id="post-tag">
              
                <span>
                  <i class="iconfont icon-inbox"></i>
                  
                    <a class="hover-with-bg" href="/categories/Optimization%20Theory">Optimization Theory</a>
                    &nbsp;
                  
                </span>
              
              <span>
                <i class="iconfont icon-tag"></i>
                
                  <a class="hover-with-bg" href="/tags/Optimization%20Theory">Optimization Theory</a>
                
              </span>
            </div>
            
              <div id="post-note">
                <div><strong>本文作者：</strong><a href="/">Coumarin</a></div>
                <div><strong>本文链接：</strong><a href="https://kumarino.com/2020/03/OptimizationTheory2/">https://kumarino.com/2020/03/OptimizationTheory2/</a></div>
                <div><strong>版权声明：</strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="nofollow noopener noopener">CC BY-NC-SA 4.0 协议</a> 。转载请注明出处！</div>
              </div>
            
            
              <div id="post-nav" class="container">
                  <div class="row">
                    
                      <a href="/2020/08/532moive1/" id="post-nav-prev" class="col">
                        <i class="fas fa-arrow-left"></i>
                        <span class="post-nav-title">在师大校外访问 532movie (一)</span>
                      </a>
                    
                    
                      <a href="/2020/02/OptimizationTheory1/" id="post-nav-next" class="col">
                        <span class="post-nav-title">最优化问题</span>
                        <i class="fas fa-arrow-right"></i>
                      </a>
                    
                  </div>
                </div>
            
          </div>
        </div>

        <!-- custom -->
        
          <div class="col-lg-7 mx-auto nopadding-md">
            <div class="container custom post-content mx-auto">
              <script> function setRewardWeChatPayURLQRCode() { document.getElementById("RewardURL").href = "wxp://f2f08LLmDyd3NUqRxtRO04K4IgirvP-KZNnP"; document.getElementById("RewardQRCode").src = "/img/RewardQRCode/WeChatReward.png"; }
function setRewardAlipayURLQRCode() { document.getElementById("RewardURL").href = "https://qr.alipay.com/FKX079043IEA1AEHJFJM84"; document.getElementById("RewardQRCode").src = "/img/RewardQRCode/Alipay.png"; }
function setRewardUnionPayURLQRCode() { document.getElementById("RewardURL").href = "https://qr.95516.com/00010002/01013347587199092167314704838465"; document.getElementById("RewardQRCode").src = "/img/RewardQRCode/UnionPay.png"; } </script> <div style="text-align:center"> <a href="wxp://f2f08LLmDyd3NUqRxtRO04K4IgirvP-KZNnP" id="RewardURL"><img src="/img/RewardQRCode/WeChatReward.png" class="rounded mx-auto d-block mt-5" style="width:150px; height:150px;" id="RewardQRCode"></a> <input type="radio" id="WeChatPay" name="RewardWay" checked="checked" onclick="setRewardWeChatPayURLQRCode()"> <label for="WeChatPay">微　信</label> <input type="radio" id="Alipay" name="RewardWay" onclick="setRewardAlipayURLQRCode()"> <label for="Alipay">支付宝</label> <input type="radio" id="UnionPay" name="RewardWay" onclick="setRewardUnionPayURLQRCode()"> <label for="UnionPay">云闪付</label> </div>
            </div>
          </div>
        

        <!-- Comments -->
        <div class="col-lg-10 mx-auto nopadding-md">
          <div class="container comments mx-auto" id="comments">
            
             <br><br>
              
              
  <div id="vcomments" style="margin: 0 auto;"></div>
  <script defer src="//cdn.jsdelivr.net/npm/valine@1.4.14/dist/Valine.min.js"></script>
  <script>
    var notify = 'true' == true ? true : false;
    var verify = 'true' == true ? true : false;
    var oldLoad = window.onload;
    window.onload = function () {
      new Valine({
        el: '#vcomments',
        app_id: "OkTuhtad3vyUmb84xrHDVKBS-gzGzoHsz",
        app_key: "YWTYjgIFkWu5cKAb0v2lyqig",
        placeholder: "说点什么",
        avatar: "retro",
        meta: ['nick', 'mail', 'link'],
        pageSize: "10"
      });
      oldLoad && oldLoad();
    };
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://valine.js.org" target="_blank" rel="nofollow noopener noopener">comments
      powered by Valine.</a></noscript>


            
          </div>
        </div>

      </div>
    </div>
    <div class="d-none d-lg-block col-lg-2 toc-container">
      
  <div id="toc">
    <p class="h4"><i class="far fa-list-alt"></i>&nbsp;目录</p>
    <div id="tocbot"></div>
  </div>


    </div>
  </div>
</div>





    
  </main>
  
<div id="sidebar" class="sidebar-hide">
  <span class="sidebar-button sidebar-button-shift" id="toggle-sidebar" >
    <i class="fa fa-arrow-right on" aria-hidden="true"></i>
  </span>
  <div class="sidebar-overlay"></div>
  <div class="sidebar-intrude">
    <div class="sidebar-avatar">
      <img src="/img/icon/Icon.png" srcset="/img/icon/Icon.png" alt="avatar"/>
    </div>
    <div class="text-center sidebar-about">
      <p class="h3 sidebar-author">Coumarin</p>
      <p class="sidebar-subtitle">Coumarin</p>
      
        <a href="https://github.com/Quejiahao" class="h4" target="_blank">
          <i class="fab fa-github" aria-hidden="true"></i>
        </a>
        &nbsp;&nbsp;
      
        <a href="mailto:i@kumarino.com" class="h4" target="_blank">
          <i class="fas fa-envelope" aria-hidden="true"></i>
        </a>
        &nbsp;&nbsp;
      
    </div>
    <div class="sidebar-friend">
      <p class="h6 sidebar-friend-title">
        <span class="sidebar-label-left"><i class="fas fa-user-friends"></i></span>
        <span class="sidebar-label">友情链接</span>
      </p>
      <ul class="list-group">
        
          <a href="https://nicebowl.moe/" target="_blank">
            <li class="list-group-item">
              <i class="fas fa-quote-left"></i>&nbsp;
              NiceBowl
            </li>
          </a>
        
          <a href="https://www.hellosirui.com/" target="_blank">
            <li class="list-group-item">
              <i class="fas fa-quote-left"></i>&nbsp;
              HelloSirui
            </li>
          </a>
        
          <a href="https://tripedal-crow.github.io/" target="_blank">
            <li class="list-group-item">
              <i class="fas fa-quote-left"></i>&nbsp;
              BlackSun
            </li>
          </a>
        
    </ul>
    </div>
  </div>
</div>


  
    <a class="z-depth-1" id="scroll-top-button" href="#" role="button">
      <i class="fa fa-chevron-up scroll-top-arrow" aria-hidden="true"></i>
    </a>
  
  
    <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
  
  <div id="footerContent"  class="rgba-black-slight">
<footer class="pt-5">
  <div class="text-center py-3">
    <div class="footer-theme">
      <a href="https://hexo.io" target="_blank" rel="nofollow noopener noreferrer">Hexo</a> theme <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener noreferrer">Fluid</a> mod by <a href="https://github.com/qixa/hexo-theme-fluid-mod" target="_blank" rel="nofollow noopener noreferrer">Julydate</a>
    </div>

    
      <div class="footer-copyright">
        
          ©2020&nbsp;Coumarin
        
        
          
            <i class="iconfont icon-love"></i>
          
          <span>萌萌哒 <span id="runtime"></span> 天啦</span>
        
      </div>
    

    

    

    
      <!-- 一言 -->
      <div class="footer-hitokoto">
        <a id="hitokotoa" href="#" target="_blank" rel="nofollow noopener noreferrer">
          <span id="hitokoto"></span>
        </a>
      </div>
    
    
  </div>
</footer>
</div>
<!-- SCRIPTS -->
<script src="/lib/popper/popper.min.js" ></script>
<script src="https://cdn.staticfile.org/twitter-bootstrap/4.3.1/js/bootstrap.min.js" ></script>
<script src="https://cdn.staticfile.org/mdbootstrap/4.8.7/js/mdb.min.js" ></script>
<script src="/js/main.js" ></script>

  <script src="/js/lazyload.js" ></script>


  
    <script src="https://cdn.staticfile.org/tocbot/4.8.1/tocbot.min.js" ></script>
  
  <script src="/js/post.js" ></script>

<!-- Plugins -->

  <script src="/lib/prettify/prettify.min.js" ></script>
  <script type="text/javascript">
    $(document).ready(function () {
      $('pre').addClass('prettyprint  linenums');
      prettyPrint();
    })
  </script>


  <script src="https://cdn.staticfile.org/typed.js/2.0.9/typed.min.js" ></script>
  <script type="text/javascript">
    var typed = new Typed('#subtitle', {
      strings: [
        '  ',
        "一维最优化问题&nbsp;",
      ],
      cursorChar: "_",
      typeSpeed: 70,
      loop: false,
    });
    typed.stop();
    $(document).ready(function () {
      $(".typed-cursor").addClass("h2");
      typed.start();
    });
  </script>


  <script src="https://cdn.staticfile.org/anchor-js/4.2.0/anchor.min.js" ></script>
  <script type="text/javascript">
    anchors.options = {
      placement: "right",
      visible: "hover",
      
    };
    var el = "h1,h2,h3,h4,h5,h6".split(",");
    var res = [];
    for (item of el) {
      res.push(".markdown-body > " + item)
    }
    anchors.add(res.join(", "))
  </script>


  <script src="/js/local-search.js" ></script>
  <script type="text/javascript">
    var path = "/local-search.xml";
    var inputArea = document.querySelector("#local-search-input");
    inputArea.onclick = function () {
      getSearchFile(path);
      this.onclick = null
    }
  </script>


  <script src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js" ></script>
  <script type="text/javascript">
  /* Fancybox */
  var setupFancybox = function () {
    $("#post img:not(.no-zoom img, img[no-zoom])").each(function() {
    var element = document.createElement("a");
      $(element).attr("data-fancybox", "gallery");
      $(element).attr("href", $(this).attr("src"));
      $(this).wrap(element);
    });
  };
  setupFancybox();
  </script>




<script>
	MathJax = {
		options: {
			renderActions: {
				addMenu: [0, '', ''],
			},
		},
		tex: {
			inlineMath: [
				["$", "$"]
			],
			displayMath: [
				["$$", "$$"],
				["\\[", "\\]"]
			],
			processEscapes: true,	// use \$ to produce a literal dollar sign
			processEnvironments: true,	// process \begin{xxx}...\end{xxx} outside math mode
			processRefs: true,	// process \ref{...} outside of math mode
			digits: /^(?:[0-9]+(?:\{,\}[0-9]{3})*(?:\.[0-9]*)?|\.[0-9]+)/,
			// pattern for recognizing numbers
			tags: "ams",	// or 'none' or 'all'
			tagSide: "right",	// side for \tag macros
			tagIndent: "0em",	// amount to indent tags
			useLabelIds: true,	// use label name rather than tag for ids
			multlineWidth: "85%",	// width of multline environment
			maxMacros: 10000,	// maximum number of macro substitutions per expression
			maxBuffer: 5 * 1024,	// maximum size for the internal TeX string (5K)
			baseURL:	// URL for use with links to tags (when there is a <base> tag in effect)
				(document.getElementsByTagName('base').length === 0) ?
					'' : String(document.location).replace(/#.*$/, ''),
			macros: {
				llt: "{\\left\\langle}",
				rgt: "{\\right\\rangle}",
				lc: "{\\left(}",
				rc: "{\\right)}",
				sep: "{\\textrm{-}}",	// 数学环境内使用 -, 而不是减号
				one: "{\\mathbbm{1}}",
				a: "{\\alpha}",
				A: "{~\\mathrm{A}}",
				AC: "{\\mathrm{AC}}",
				al: "{\\bm\\alpha}",
				ba: "{\\beta}",
				bA: "{\\bm A}",
				bbH: "{\\mathbb{H}}",
				bbS: "{\\mathbb{S}}",
				be: "{\\bm\\beta}",
				bh: "{\\bm h}",
				bs: ["{\\raisebox{.2em}{$#1$}\\left/\\raisebox{-.2em}{$#2$}\\right.}", 2],	// 斜线除号
				bm: ["{\\boldsymbol{#1}}", 1],
				bT: "{\\mathbb{T}}",
				bU: "{\\bm U}",
				BV: "{\\mathrm{BV}}",
				bx: "{\\bm x}",
				C: "{\\mathbb{C}}",	// 复数 C
				mca: "{\\mathcal}",
				cis: "{\\displaystyle\\bigcap_{k = 1}^\\infty}",
				cov: "{\\mathbf{Cov}}",
				csum: "{\\displaystyle\\sum_{k = 1}^\\infty}",
				cT: "{\\mathcal{T}}",
				cu: "{\\displaystyle\\bigcup_{k = 1}^\\infty}",
				curl: "{\\mathbf{curl}}",
				ch: "{\\mathrm{ch}~}",	// 双曲余弦
				diam: "{\\mathrm{diam}~}",
				de: "{\\delta}",
				dba: "{\\displaystyle\\bigcap}",	// 集合交
				dbigcap: "{\\displaystyle\\bigcap}",	// 集合交
				dbigcup: "{\\displaystyle\\bigcup}",	// 集合并
				dbu: "{\\displaystyle\\bigcup}",	// 集合并
				di: "{\\mathrm{d}}",	// 微分算符 d
				diff: "{\\mathrm{d}}",	// 微分算符 d
				dinf: "{\\displaystyle\\inf}",
				divr: "{\\mathbf{div}}",
				diag: "{\\mathrm{diag}}",	// 对角矩阵 diag
				dint: "{\\displaystyle\\int}",
				dlim: "{\\displaystyle\\lim}",
				dmax: "{\\displaystyle\\max}",
				dmin: "{\\displaystyle\\min}",
				dsum: "{\\displaystyle\\sum}",	// 求和号
				dsup: "{\\displaystyle\\sup}",
				dmmm: "{~\\mathrm{dm^3}}",
				D: "{\\Delta}",
				Di: "{\\mathrm{D}}",	// 微分算符 D
				e: "{\\mathrm{e}}",	// 自然对数的底数
				E: "{\\mathbb{E}}",	// \R 上赋予了欧氏拓扑
				et: "{\\bm\\eta}",
				ep: "{\\varepsilon}",
				fb: "{\\bm f}",
				g: "{~\\mathrm{g}}",
				ga: "{\\bm\\gamma}",
				geq: "{\\geqslant}",	// 大于或等于号, 下面一划是斜的
				grad: "{\\mathbf{grad}}",
				h: "~\\mathrm{h}}",
				heq: "{\\mathbin{\\widehat{=}}}",
				hin: "{\\mathbin{\\widehat{\\in}}}",
				H: "{\\mathrm{H}}",	// 共轭转置 H
				i: "{\\mathrm{i}}",	// 虚数单位 i
				id: "{\\mathrm{id}}",
				im: "{\\mathrm{Im}~}",
				I: "{\\bm{I}}",		// 单位矩阵 I
				Int: "{\\mathrm{Int}}",	// 内部
				J: "{~\\mathrm{J}}",
				JK: "{~\\mathrm{J}~\\cdot ~\\mathrm{K}^{-1}}",
				kJ: "{~\\mathrm{kJ}}",
				K: "{~\\mathrm{K}}",
				Ker: "{\\mathrm{Ker}}",
				ls: "{\\left[}",
				lb: "{\\left\\{}",
				ld: "{\\left.}",
				lllcdots: "{$\\cdots\\cdots\\cdots\\cdots\\cdots\\cdots\\cdots\\cdots\\cdots\\cdots\\cdots\\cdots\\cdots\\cdots\\cdots\\cdots\\cdots\\cdots\\cdots\\cdots$}",
				lrb: ["{\\left\\{ #1 \\right\\}}", 1],
				lrv: ["{\\left| #1 \\right|}", 1],
				lrvv: ["{\\left\\| #1 \\right\\|}", 1],
				lv: "{\\left|}",
				leq: "{\\leqslant}",	// 小于或等于号, 下面一划是斜的
				mf: ["{\\marginpar{\\footnotesize #1}}", 1],
				m: "{\\mathrm{m}}",
				mol: "{~\\mathrm{mol}}",
				mr: "{\\mathring}",
				ms: ["{\\marginpar{\\scriptsize #1}}", 1],
				N: "{\\mathbb{N}}",	// 自然数集 N
				om: "{\\omega}",
				oR: "{\\overline{\\mathbb{R}}}",
				ol: "{\\overline}",
				p: "{\\varphi}",
				proj: "{\\mathrm{proj}~}",	// 向量的投影 proj
				pa: "{\\partial}",
				Pa: "{~\\mathrm{Pa}}",
				pl: "{\\mathbin{/\\mskip-2.5mu/}}",
				Q: "{\\mathbb{Q}}",	// 有理数 Q
				rs: "{\\right]}",
				rb: "{\\right\\}}",
				rd: "{\\right.}",
				rv: "{\\right|}",
				rank: "{\\mathrm{rank}~}",	// 矩阵的秩 rank
				R: "{\\mathbb{R}}",	// 实数域 R
				rel: "{\\mathrm{rel}}",
				Rie: "{\\mathcal{R}}",	// 黎曼可积 R
				RP: "{\\mathbb{RP}}",	// 实数域 R
				RR: "{\\mathrm{R}}",
				s: "{~\\mathrm{s}}",
				scr: "{\\mathscr}",
				sg: "{\\sigma}",
				sgn: "{\\mathrm{sgn}}",	// 符号函数
				sh: "{\\mathrm{sh}}",	// 双曲正弦
				sn: "{\\mathrm{span}}",
				st: "{~\\textrm{s.t.}~}",
				sx: "{\\mathscr{X}}",
				supp: "{\\mathrm{supp}}",
				T: "{\\mathrm{T}}",	// 转置 T
				te: "{\\theta}",
				tr: "{\\mathrm{tr}~}",	// 矩阵的迹 tr
				tah: "{\\mathrm{th}~}",	// 双曲正切
				U: "{\\mathring{U}}",	// 去心邻域 U 上面有一圈
				V: "{~\\mathrm{V}}",
				wh: ["{\\widehat{ #1}}", 1],
				wt: "{\\widetilde}",
				xra: "{\\xrightarrow}",
				xle: "{\\xlongequal}",
				xLra: "{\\xLongrightarrow}",
				Z: "{\\mathbb{Z}}",	// 整数 Z
			},
			/*require: {
				allow: {
					base: false,
					'all-packages': false
				},
				defaultAllow: true,
			},*/
			/*tagFormat: {
				number: (n) => n.toString(),
				tag: (tag) => '(' + tag + ')',
				id: (id) => 'mjx-eqn-' + id.replace(/\s/g, '_'),
				url: (id, base) => base + '#' + encodeURIComponent(id),
			},*/
			/*color: {
				padding: '5px',
				borderWidth: '2px'
			},*/
			/*amsCd: {
				colspace: '5pt',
				rowspace: '5pt',
				harrowsize: '2.75em',
				varrowsize: '1.75em',
				hideHorizontalLabels: false
			},*/
		},
		chtml: {
			scale: 1,	// global scaling factor for all expressions
			minScale: .5,	// smallest scaling factor to use
			matchFontHeight: true,	// true to match ex-height of surrounding font
			mtextInheritFont: true,	// true to make mtext elements use surrounding font
			merrorInheritFont: true,	// true to make merror text use surrounding font
			mathmlSpacing: false,	// true for MathML spacing rules, false for TeX rules
			skipAttributes: {},	// RFDa and other attributes NOT to copy to the output
			exFactor: .5,	// default size of ex in em units
			displayAlign: "center",	// default for indentalign when set to 'auto'
			displayIndent: "0",	// default for indentshift when set to 'auto'
			// fontURL: 'https://cdn.staticfile.org/mathjax/3.0.5/es5/output/chtml/fonts/woff-v2',	// The URL where the fonts are found
			adaptiveCSS: true	// true means only produce CSS that is used in the processed equations
		},
		svg: {
			scale: 1,
			minScale: .5,
			matchFontHeight: true,
			mtextInheritFont: true,
			merrorInheritFont: true,
			mathmlSpacing: false,
			skipAttributes: {},
			exFactor: .5,
			displayAlign: 'center',
			displayIndent: '0',
			fontCache: 'local',	// or 'global' or 'none'
			localID: null,	// ID to use for local font cache (for single equation processing)
			internalSpeechTitles: true,	// insert <title> tags with speech content
			titleID: 0	// initial id number to use for aria-labeledby titles
		},
	};
</script>
<script src="https://cdn.staticfile.org/mathjax/3.0.5/es5/tex-chtml.js" ></script>



  <script src="https://cdn.jsdelivr.net/npm/smoothscroll-for-websites@1.4.10/SmoothScroll.min.js" ></script>
  <style type="text/css">
    html, body{
      scroll-behavior: smooth;
    }
    @media screen and (prefers-reduced-motion: reduce){
      html, body{
        scroll-behavior: auto;
      }
    }
  </style>



  <!-- 随机背景 -->
  <script src="https://cdn.staticfile.org/danielgindi-jquery-backstretch/2.1.15/jquery.backstretch.min.js" ></script>
  
  
    <!-- 本地随机背景 -->
    <script type="text/javascript">
      !function(){
        var random_bg_string = "https://img.xjh.me/desktop/bg/acg/64082849_p0.jpg,https://img.xjh.me/desktop/bg/acg/63946708_p0.jpg,https://img.xjh.me/desktop/bg/acg/59756207_p0.jpg,https://img.xjh.me/desktop/bg/acg/63374320_p0.jpg,https://img.xjh.me/desktop/bg/nature/59190594_p0.jpg,https://img.xjh.me/desktop/bg/acg/63093148_p0.jpg,https://img.xjh.me/desktop/bg/acg/62494753_p0.jpg,https://img.xjh.me/desktop/bg/acg/61749296_p0.jpg,";
        /* 去除图片链接组末尾逗号并转换为数组 */
        random_bg_string = random_bg_string.substring(0,random_bg_string.length-1);
        var random_bg_array = random_bg_string.split(",");
        /* 首张图片随机 */
        var n = Math.floor(Math.random() * random_bg_array.length);
        $(".banner-bg").backstretch(
          random_bg_array,
          {
            duration: 20 * 1000,
            fade: 2 * 1000,
            start: n,
            animateFirst: false
          }
        );
      }();
    </script>
  


  <script type="text/javascript">
  /*一言API*/
  $(document).ready(function(){
    getHitokoto();
  });
  function hitokoto(e) {
    $("#hitokoto").stop().fadeOut(function() {
      $("#hitokoto").html(e.hitokoto);
      var element = document.getElementById('hitokotoa');
      element.href = "https://hitokoto.cn/?uuid=" + e.uuid;
      $("#hitokoto").stop().fadeIn()
    })
  };
  function getHitokoto() {
    var e = ["a", "b", "c", "d", "e", "i"];
    fetch('https://v1.hitokoto.cn/?encode=json&charset=utf-8&c=' + e[Math.floor(Math.random() * e.length)],{
      cache: 'no-cache',
      method: 'GET',
      mode: 'cors'
    }).then(
      response => response.json()
    ).then(
      data => {
        hitokoto(data)
        setTimeout(getHitokoto, 1e4)
      }
    ).catch(
      console.error
    )
  };
  </script>


  <script async src="//cdn.jsdelivr.net/npm/busuanzi@2.3.0/bsz.pure.mini.js" ></script>
  


  
  
    <script type="text/javascript">
      //定义获取词语下标
      var a_idx = 0;
      jQuery(document).ready(function ($) {
        //点击body时触发事件
        $("body").click(function (e) {
          //需要显示的词语
          var a = new Array("富强", "民主", "文明", "和谐", "自由", "平等", "公正", "法治", "爱国", "敬业", "诚信", "友善");
          //设置词语给span标签
          var $i = $("<span/>").text(a[a_idx]);
          //下标等于原来下标+1  余 词语总数
          a_idx = (a_idx + 1) % a.length;
          //获取鼠标指针的位置，分别相对于文档的左和右边缘。
          //获取x和y的指针坐标
          var x = e.pageX, y = e.pageY;
          //在鼠标的指针的位置给$i定义的span标签添加css样式
          $i.css({
            "z-index": 999,
            "top": y - 20,
            "left": x,
            "position": "absolute",
            "font-weight": "bold",
            "color": rand_color()
          });
          // 随机颜色
          function rand_color() {
            return "rgb(" + ~~(255 * Math.random()) + "," + ~~(255 * Math.random()) + "," + ~~(255 * Math.random()) + ")"
          }
          //在body添加这个标签
          $("body").append($i);
          //animate() 方法执行 CSS 属性集的自定义动画。
          //该方法通过CSS样式将元素从一个状态改变为另一个状态。CSS属性值是逐渐改变的，这样就可以创建动画效果。
          //详情请看http://www.w3school.com.cn/jquery/effect_animate.asp
          $i.animate({
            //将原来的位置向上移动180
            "top": y - 180,
            "opacity": 0
            //1500动画的速度
          }, 1500, function () {
            //时间到了自动删除
            $i.remove();
          });
        });
      })
      ;
    </script>
  


<!-- Functions -->
<script type="text/javascript">
  /* 切换背景 */
  
  $("#background").removeClass("banner-bg");
  $("body").addClass("banner-bg");
  var postToTopHight = $("#board").offset().top;
  $(window).scroll(function () {
    var bgDisplay = false;
    var scrollHeight = document.body.scrollTop + document.documentElement.scrollTop;
    bgDisplay = scrollHeight >= postToTopHight;
    if(bgDisplay) {
      $('#background').removeClass("rgba-black-slight");
      $('#mainContent').removeClass("rgba-black-slight");
      $('#footerContent').removeClass("rgba-black-slight");
    } else {
      $('#background').addClass("rgba-black-slight");
      $('#mainContent').addClass("rgba-black-slight");
      $('#footerContent').addClass("rgba-black-slight");
    }
  });
  
</script>

  <script type="text/javascript">
    /*显示博客运行时间*/
    var blogRunTime = function () {
      var runTime = document.getElementById("runtime");
      var runtimeDate = "2020,02,20";
	    var createDate = new Date(runtimeDate);
	    var nowDate = new Date();
	    var dateLine = nowDate.getTime() - createDate.getTime();
	    var runDate = Math.floor(dateLine / (1000 * 60 * 60 * 24));
	    runTime.innerHTML = runDate;
    };
    $(document).ready(function(){
	    blogRunTime();
    });
  </script>


  <script type="text/javascript">
    /*窗口监视*/
    var originalTitle = document.title;
    window.onblur = function(){document.title = "你不爱我了 QAQ"};
    window.onfocus = function(){document.title = originalTitle};
  </script>


  <script type="text/javascript">
    /* 雪花效果 */
    console.log('雪花效果 code by kvv.me');
    ~function () {
      function t() {
          e.width = window.innerWidth,
          e.height = window.innerHeight,
          o = Math.round(window.innerWidth * window.innerHeight / 1e4)
      }
      function n() {
          var t = window.innerWidth
            , d = window.innerHeight
            , c = e.getContext("2d");
          c.clearRect(0, 0, t, d),
          c.fillStyle = "rgba(255, 255, 255, 0.7)",
          c.beginPath(),
          a += .01;
          for (var u = 0; o > u; u++) {
            var l = r[u];
            if (!l) {
              continue
            }
            ;c.moveTo(l.x, l.y),
            c.arc(l.x, l.y, l.radius, 0, 2 * Math.PI, !0),
            l.y += Math.cos(a) + l.radius / 2,
            l.x += Math.sin(a * l.direction),
            (l.x > t + 5 || -5 > l.x || l.y > d) && (u % 3 > 0 ? (r[u].x = Math.random() * t,
            r[u].y = -10) : Math.sin(a * l.direction) > 0 ? (r[u].x = -5,
            r[u].y = Math.random() * d) : (r[u].x = t + 5,
            r[u].y = Math.random() * d))
          }
          c.fill(),
          i(n)
      }
      var e = document.createElement("canvas")
        , i = requestAnimationFrame || msRequestAnimationFrame || function(t) {
          setTimeout(t, 16)
        }
      , a = 0
      , o = 0
      , r = [];
      t(),
      e.className = "snow",
      document.body.appendChild(e);
      for (var d = 0; o > d; d++)
        r.push({
            x: Math.random() * window.innerWidth,
            y: Math.random() * window.innerHeight,
            radius: 4 * Math.random() + 1,
            direction: 2 * Math.random() - .5
        });
      addEventListener("resize", t),
      i(n)
    }();
  </script>


 
 

<!-- 腾讯统计 -->
<script>
  var _mtac = {};
  (function() {
    var mta = document.createElement("script");
    mta.src = "//pingjs.qq.com/h5/stats.js?v2.0.4";
    mta.setAttribute("name", "MTAH5");
    mta.setAttribute("sid", "500711567");
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(mta, s);
  })();
</script>
 
 
 
 

  
</body>
</html>